---
title: "Clase4Comit"
author: "HECTOR HERNANDEZ"
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

You can add options to executable code like this

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).


```{r}
library(tidyverse)
library(fpp3)
```

```{r}
medicinas <- read.csv("datos/medicinas.csv")
medicinas
```

```{r}
medicinas <- medicinas |> 
  mutate(fecha = yearmonth(fecha)) |> 
  as_tsibble(index = fecha)

medicinas
```


```{r}
medicinas |> 
  autoplot(Cost)
```

```{r}
medicinas |> 
  model(classical_decomposition(Cost)) |> 
  components() |> 
  autoplot()
```


```{r}
medicinas_dcmp <- medicinas |>
  model(dcmp_clasica_mult = classical_decomposition(Cost, type = "multiplicative"))

dcmp_clasica_add <- medicinas |>
  model(classical_decomposition(Cost, type = "additive")) |>
  components()

medicinas_dcmp

medicinas_dcmp |>
  components() |>
  ggplot(aes(x = fecha)) +
  geom_line(aes(y = Cost), color = "grey") +
  geom_line(aes(y = season_adjust), color = "blue")

medicinas_dcmp |>
  components() |>
  autoplot()

```

```{r}
medicinas |>
  autoplot(Cost)

medicinas |>
  autoplot(log(Cost))

lambda_med <- medicinas |>
  features(Cost, features = guerrero) |>
  pull(lambda_guerrero)

medicinas |>
  autoplot(box_cox(Cost, lambda = lambda_med))
```


```{r}
medicinas_stl <- medicinas |> 
  model(stl = STL(log(Cost) ~ trend(window =21) + season(window = "periodic"))) |> 
  components()

medicinas_stl |> 
  autoplot()
```









































